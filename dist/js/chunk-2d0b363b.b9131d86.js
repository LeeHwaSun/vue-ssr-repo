(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b363b"],{"27bb":function(t,i,e){"use strict";e.r(i);var s=function(){var t=this,i=t._self._c;return i("v-container",{attrs:{fluid:""}},[i("v-toolbar",[i("v-toolbar-title",[t._v(t._s(t.pageTitle))]),i("v-spacer"),i("v-btn",{attrs:{color:"primary",loading:t.loading},on:{click:t.save}},[i("v-icon",{attrs:{left:""}},[t._v("mdi-pencil")]),t._v(" 저장 ")],1)],1),t.form?i("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(i){t.valid=i},expression:"valid"}},[i("input-duplicate-check",{ref:"id",attrs:{label:"ID",rules:[t.rules.required({label:"ID"}),t.rules.alphaNum()],cbCheck:t.checkId,origin:t.id?t.form.wr_1:"",readonly:!!t.id},model:{value:t.form.wr_1,callback:function(i){t.$set(t.form,"wr_1",i)},expression:"form.wr_1"}}),i("v-select",{attrs:{label:"컨텐츠 스킨",items:t.skins},model:{value:t.form.wr_2,callback:function(i){t.$set(t.form,"wr_2",i)},expression:"form.wr_2"}}),i("v-text-field",{attrs:{label:"제목",counter:"120",rules:[t.rules.required({label:"제목"})]},model:{value:t.form.wr_title,callback:function(i){t.$set(t.form,"wr_title",i)},expression:"form.wr_title"}}),i("ez-tiptap",{attrs:{editable:!0},on:{uploadImage:t.uploadImage},model:{value:t.form.wr_content,callback:function(i){t.$set(t.form,"wr_content",i)},expression:"form.wr_content"}})],1):t._e()],1)},r=[],a=e("2f62"),o=e("248f"),n=e.n(o),l=e("91ca"),c={components:{InputDuplicateCheck:l["a"]},name:"BasicForm",title(){return this.pageTitle},props:{config:Object,access:Object,id:[String,Number]},data(){return{form:null,valid:!0,confirmPw:"",uploadFiles:Array(this.config.brd_upload_cnt).fill(null),tags:[],loading:!1,upImages:[],isWrite:!1,parentItem:null,skins:[]}},computed:{...Object(a["e"])({user:t=>t.user.user}),table(){return this.config.brd_table},pid(){return"reply"==this.$route.query.act?this.id:0},pageTitle(){let t="";return t=this.pid?" 게시물 답글 작성":this.id?" 게시물 수정":" 게시물 작성",this.config.brd_subject+t},rules:()=>n.a},mounted(){this.init(),this.fetchSkinList()},destroyed(){!this.isWrite&&this.upImages.length&&this.$axios.put("/api/board/imgCancel/"+this.table,this.upImages)},methods:{async checkId(){const t=await this.$axios.get("/api/contents/duplicateCheck?wr_1="+this.form.wr_1);return t},async fetchSkinList(){const t=await this.$axios.get("/api/contents/skinList");this.skins=t},async init(){if(this.id){const t=await this.$axios.get(`/api/board/detail/${this.table}/${this.id}`);this.pid?(this.initForm(),this.form.wr_category=t.wr_category,this.parentItem=t):this.form=t,this.form.wr_password=""}else this.initForm()},initForm(){const t={wr_reply:0,wr_parent:this.pid,user_id:this.user?this.user.user_id:0,wr_email:this.user?this.user.user_email:"",wr_name:this.user?this.user.user_name:"",wr_password:"",wr_category:this.$route.query.ca||this.config.brd_category[0]||"",wr_title:"",wr_content:"",wrTags:[]};for(let i=1;i<=10;i++)t["wr_"+i]="";t.wr_2="basic",this.form=t},fileTitle(t){if(this.form.wrFiles){const i=this.form.wrFiles[t-1];return i&&!i.remove?i.brd_file_name:"첨부파일 "+t}return"첨부파일 "+t},async uploadImage({file:t,desc:i,callback:e}){const s=new FormData;s.append("upFile",t),s.append("brd_file_desc",i);const r=await this.$axios.post("/api/board/imageUpload/"+this.table,s);this.upImages.push(r),e(`/upload/${this.table}/${r.brd_file_src}`)},async save(){if(this.$refs.form.validate(),await this.$nextTick(),!this.valid)return;if(!this.$refs.id.validate())return;this.loading=!0;const t=new FormData,i=Object.keys(this.form);for(const r of i)"object"===typeof this.form[r]?t.append(r,JSON.stringify(this.form[r])):t.append(r,this.form[r]);this.$route.query.token&&t.append("token",this.$route.query.token);let e,s=0;for(let r=0;r<this.config.brd_upload_cnt;r++)null!=this.uploadFiles[r]&&(t.append("upFiles["+s,this.uploadFiles[r]),s++);t.append("upImages",JSON.stringify(this.upImages)),e=this.id&&!this.pid?await this.update(t):await this.insert(t),e&&(this.isWrite=!0,this.$router.push("/board/"+this.table)),this.loading=!1},async insert(t){const i=await this.$axios.post("/api/board/write/"+this.table,t);return i.wr_id},async update(t){const i=await this.$axios.put(`/api/board/write/${this.table}/${this.id}`,t);return i.wr_id}}},u=c,d=e("2877"),h=Object(d["a"])(u,s,r,!1,null,null,null);i["default"]=h.exports}}]);
//# sourceMappingURL=chunk-2d0b363b.b9131d86.js.map